var input = ".........###......#...#.......#\n" +
    ".#.#...........#..#..#.........\n" +
    "#.......#.................#....\n" +
    ".........#.#.........#......###\n" +
    ".....#......##...##............\n" +
    "...##...#......#.....#.....##..\n" +
    "#.#..#....#...#....#......#....\n" +
    "........##.....#.....#.#.......\n" +
    "......#.....#......#...##.#....\n" +
    "...####...#.......##.....#.#...\n" +
    ".........#....#......##........\n" +
    "..##...........###.#...........\n" +
    ".....#............#............\n" +
    "#.#..#..##........#.....#..#...\n" +
    ".....................#....##..#\n" +
    "...........##.....###...#.#.#..\n" +
    "..#......#...........#.........\n" +
    ".##.##...#...#......##.#.......\n" +
    "......#..#......#.#.#..#.#.....\n" +
    "........#.#..#..........#...#.#\n" +
    "...........##...........#....#.\n" +
    "...........#...##.#............\n" +
    ".......#...........#...........\n" +
    ".......#......#..#...#....#..#.\n" +
    "..#.....#.#....#.#......#...#.#\n" +
    ".#..........###..#....#........\n" +
    "........##..#..#...#..#....#..#\n" +
    "#..........#...#..#.#........#.\n" +
    "..#.#........##.##....##.#.....\n" +
    "#.##....#...#.......#.#..#....#\n" +
    "......##...#.#.#.#.....#....#..\n" +
    "..........#..............#.....\n" +
    "....................###.#......\n" +
    "#.....#...#...#.#.......#....#.\n" +
    ".......#..#...................#\n" +
    "........##.##........#......#..\n" +
    "...#...##.#...#...........#....\n" +
    "..#.........#...#....##......#.\n" +
    "......#..............#..#..#.#.\n" +
    ".....##...#...#...##....#......\n" +
    "#.#....#...#......##.....#...##\n" +
    ".#...#.#..................#....\n" +
    "#.##.....#......#..........#...\n" +
    "..#..#.......#.................\n" +
    "..#.....#.........#........#...\n" +
    ".......#...##.##.#..#..##.#..#.\n" +
    "#.............#.........#.#....\n" +
    "..#..##..........#..#..##.#.#..\n" +
    ".#......#.......#...#.....##.#.\n" +
    ".....#......#...#...........###\n" +
    "..........#.........#.....#....\n" +
    ".....#..........#.......##...#.\n" +
    "......#..#..#..............#...\n" +
    ".#.####..#...##...#.#..........\n" +
    "..#....#.......#........#.....#\n" +
    "....#.##.....#..#.....#.#.#..#.\n" +
    ".......#..#..##.......#........\n" +
    ".#.....#...........#.....#.....\n" +
    "........#..........##..##.#....\n" +
    ".#.....#........#.....#..#.....\n" +
    "..#..........#...#......##..#..\n" +
    ".#............#.........#....#.\n" +
    "........#..###.......#.....###.\n" +
    "##.#...#.#..#..#..#.#.##...#...\n" +
    ".#....#...#..#......##.........\n" +
    ".............##.....##.........\n" +
    ".....##.#..###.#....#...#...#.#\n" +
    "#........#...#......#...#.##...\n" +
    "#....#......#.....###.##.#.....\n" +
    ".....#..#.#.##....#..##.....##.\n" +
    "....#...#...#..........##......\n" +
    "..........#......#...#.....##..\n" +
    ".....##....##.#.............#.#\n" +
    "#.........#.##.............#..#\n" +
    ".....#.........##.#...#.#.#....\n" +
    "..........#..#......#..#.....#.\n" +
    "....#....#....#....#.......###.\n" +
    "....#...#..##....#..##..#...##.\n" +
    ".###......#...........###......\n" +
    "#..................####.#....#.\n" +
    "#....#.#.....#.#....#..#.......\n" +
    "...#......#....##......#..#..#.\n" +
    "#.#...#.##.....#.#.......##..#.\n" +
    ".........##.................#..\n" +
    "#..##.#....#.#.............#...\n" +
    "....................####.#.#..#\n" +
    ".......#..#...#..#..#.....#...#\n" +
    ".....#.#.#........#....#...##..\n" +
    "......#..#....#......#..##.....\n" +
    "............#......##.#....#..#\n" +
    "...#..........#..#...........#.\n" +
    "..........#.............###....\n" +
    "....##.#.#......#.#..#....##..#\n" +
    "..#..........#........#......#.\n" +
    "..#...........####......##..#.#\n" +
    "...##......##...#..#.##........\n" +
    ".....#...#.....##.....###..##..\n" +
    ".#.##.....#....##....#.........\n" +
    "#....##..#.....#.#......#.#....\n" +
    "..#.......#...#....#...#.#.....\n" +
    "...........#.........#.........\n" +
    "..#..#....##..#....#....#.....#\n" +
    ".......#..#....##....#.........\n" +
    "#.........#...........##....##.\n" +
    "#........#.#...............##..\n" +
    "#...##.#...............#.......\n" +
    "#....#..#......#..#.###...##..#\n" +
    "..#.........#.#......#.....#..#\n" +
    "......#...........##........##.\n" +
    ".#.........#................#..\n" +
    "#...#...............#...#....#.\n" +
    ".#.#......##.........#.#.......\n" +
    "..........#....................\n" +
    ".#.....#..#...#.#.#.......#...#\n" +
    "..#..........#.................\n" +
    ".#.#.....#.#......#...#.....##.\n" +
    ".....#.#..##...##..#..###...#..\n" +
    "......#......#.#......#.##.....\n" +
    "#.#......#...#.......#....#....\n" +
    "..........#....#.#..#.....##...\n" +
    "#...........#.#....#.##....#.#.\n" +
    "#.#....#..#.........###....#...\n" +
    "..............#..##.......#....\n" +
    ".......................#.##.#..\n" +
    "##...............##....#..#.#..\n" +
    ".#.#..#.##...#.............#...\n" +
    "...#...........#............#..\n" +
    "..#......#........##....#.#.##.\n" +
    ".#.#..#........#....#....#....#\n" +
    ".#.....#.##....#.....#..#...#..\n" +
    "......#...#..........#..###....\n" +
    "..#.#.......#........#........#\n" +
    ".......##.####..........#......\n" +
    ".#.#..#......##..#.........#..#\n" +
    "..#...##.#.......#...#.##...#.#\n" +
    "#.#..........#..#.#.#..........\n" +
    ".....#......#............#.....\n" +
    "........###...#.......#........\n" +
    ".....#.##....#....#............\n" +
    "...#.#....##.....#.....#.......\n" +
    "..#.............#......#.......\n" +
    ".#....#...#....##..#......#....\n" +
    "..#.....#.#............#.......\n" +
    "......#........##.........#...#\n" +
    ".......#........#..#.#.#...##.#\n" +
    "#....#...#..#.......#....##....\n" +
    "#...##.#.#.....#.......#.......\n" +
    ".....#........#.#.....#...##...\n" +
    "..#....#..##......#.#.....#...#\n" +
    "....#.....#......#.....#.......\n" +
    "#.#....#......#...##...........\n" +
    "..#.......#...#...............#\n" +
    "........#........#.............\n" +
    "#.#.#......#...#..#..........#.\n" +
    ".##...#.........#........#..#..\n" +
    "#.#.#...#.#.......#.....#...#..\n" +
    "...#..............#..........#.\n" +
    "#.#...#.###.............#......\n" +
    "................#.....###.##.#.\n" +
    ".......#..........#....#..#....\n" +
    "......##....#..#..##...........\n" +
    "...#...#.....######.......#....\n" +
    "..##.....##.#...#.........#.#.#\n" +
    ".......#...#..#.#.#...........#\n" +
    "........###.............#...#.#\n" +
    "#.....#.........#.............#\n" +
    "..#...#.....#..................\n" +
    ".....#....#.....#......#.#....#\n" +
    "...#....#........##...#.......#\n" +
    "...##.#...#.....#..............\n" +
    "..#.##....##..#.........#......\n" +
    ".....#..#.#....#...#......#.#..\n" +
    "...........##..##...#..#..###..\n" +
    "#...........#.........####....#\n" +
    ".#...........#...........###...\n" +
    "........#................#.....\n" +
    ".....#....#............#....#.#\n" +
    "...#...#.......#...............\n" +
    "#.....##.#.......#.#...........\n" +
    "#.......#.#.#.#..#...#.........\n" +
    "....####.#...#.#......#.....##.\n" +
    "...##...#.....#.#......#..#....\n" +
    "..........#..#....#......###...\n" +
    "...................#....##...#.\n" +
    "....#......#........#...##..#..\n" +
    "##...#.........#.#......#......\n" +
    "#........#...#....#......#.....\n" +
    "#..#.......#...............##..\n" +
    "......##......#...........##.#.\n" +
    "......#..#....#....#.##........\n" +
    "..#....#..#.#.###....#.........\n" +
    ".#......#..#..............#....\n" +
    ".#..........#...#..#.#...#.....\n" +
    "....#......#..#......#....#....\n" +
    "...##.....#............####..#.\n" +
    "......#.#...#....#..#...#..#.#.\n" +
    "......##.......................\n" +
    "#.##........#...........####..#\n" +
    ".....#......#.......#.#....#...\n" +
    "#.......#....#.....#....#...##.\n" +
    ".....#..##.#...........#..#...#\n" +
    "...........#.##.#.#...#.#..#...\n" +
    "..#.......#.#....#..#..........\n" +
    "...#.......##..#.............#.\n" +
    "....#..#....#....#...#....#....\n" +
    "#......#.#...##..........#..#..\n" +
    "..#.#.......#.........#......#.\n" +
    "#...............#.............#\n" +
    "....##..#......................\n" +
    ".##....#............#......#...\n" +
    ".......#....#..##......##......\n" +
    "#..##.....#..#..........#......\n" +
    "...#.........#.......#..##.....\n" +
    "....#.##.....#.#...#...#.....#.\n" +
    "##...........#.#..#...#.#......\n" +
    "....#.............##...#.#..#..\n" +
    "...#....#......................\n" +
    "#..#...##.#.......#.##..#.###..\n" +
    "...##.#.#...##........##...#...\n" +
    "......##..#..#.....#..#.#..#...\n" +
    "#.......##...............##.#..\n" +
    ".##......#..#....#...##..#..#.#\n" +
    "##.........##..#...#.....##....\n" +
    "...#..........#...#..##.#......\n" +
    "..##.#........#...#..........##\n" +
    ".......................##.#....\n" +
    "....#...#...#..###.#.......#.##\n" +
    "....#....#.#..........#.##.....\n" +
    "..#..........##...#....#.......\n" +
    ".....#.....#.....#..#.........#\n" +
    "..##..##..#..#....#..#.......##\n" +
    ".............#............##...\n" +
    "....#.#.#.......###.........#..\n" +
    "...##.#..........#.#...#.#.....\n" +
    ".#........#..#.#.#..#..........\n" +
    "...##...#.....##.......#..#..#.\n" +
    "...#......#..#.......##.#.#....\n" +
    ".........#.........##........#.\n" +
    ".........##..................##\n" +
    "....##.....#................#..\n" +
    "....#..................##...#.#\n" +
    ".........#..............#......\n" +
    "...#......#..#..#....#..#...##.\n" +
    ".#.##......##...#.#......#.#...\n" +
    "...#.#...###....#...#.#..#....#\n" +
    "....#..#.......#.....#..##.#.#.\n" +
    "#.#.#..#.......#####.#..##..#..\n" +
    "#..........#.....#..#.#..#.....\n" +
    ".#......#...#..#.#..#..#.......\n" +
    "...#....##...#..........#.##.#.\n" +
    "#.##..#...#..................#.\n" +
    "......#.###..#..#..#.......#...\n" +
    "...#....#...#..#............###\n" +
    "#.........#........#.......#...\n" +
    "...#..#.................#....##\n" +
    "...#.#.............##......#...\n" +
    "##....#.##.............##......\n" +
    "#............#..#..#.....#.....\n" +
    "....#........#...#.....#.#...##\n" +
    "..#.##..#.....................#\n" +
    "#.#........#...#..#...#.#......\n" +
    "...#..#...........##.....#.....\n" +
    "......#.#....#..##...#.....#...\n" +
    "......#......#.###..##.........\n" +
    "....#.......#...##.##.....#....\n" +
    "#.....##....#........#..##.....\n" +
    ".#..#..#..#..#.#...#...#.......\n" +
    ".......##...#......#.........#.\n" +
    ".#..##....#.....#...........##.\n" +
    ".......##....#.#........#......\n" +
    "..#.#.#....#...................\n" +
    ".#...#.......#...#.#......#....\n" +
    "..##.##..##...........###......\n" +
    "#...#......#.......#...........\n" +
    "#....##.#.......#.........#....\n" +
    ".............##.#.#..#...#...#.\n" +
    "..##.##...........#.........##.\n" +
    "#.#...#..........#.#....#....##\n" +
    ".....#.....#..##..#............\n" +
    "#.........#.........#.#...##..#\n" +
    "...#.#.....#.........###..#....\n" +
    "..#.#.##.#...................#.\n" +
    "......####....#.......#.......#\n" +
    ".........#..#..#....#..##......\n" +
    "....#..........#...##........#.\n" +
    "..........#..#....#.....#....#.\n" +
    ".#.#.................#....#....\n" +
    ".......#......#.....#...##.....\n" +
    "....#..............#...........\n" +
    "###...........##.#...........#.\n" +
    "...####.......#...#....#.#...#.\n" +
    "..##.#................#........\n" +
    "...#..#....#.....#.....##..#...\n" +
    "##.#....#....##..........#.#..#\n" +
    "...#....#.....#................\n" +
    "..#...#....#..#..#.##.##..#....\n" +
    "....#....#.##.....#...#......#.\n" +
    "......#................#..#..#.\n" +
    "...##..#...#....#.#.....#..#...\n" +
    "#...#..............#.#.....#.#.\n" +
    "....#.........#.##...#.#....#..\n" +
    "..................#..##.#......\n" +
    ".#.....#.....#.............#..#\n" +
    "..........####....###..##...#..\n" +
    "......#........#...#......##..#\n" +
    "#......#.#..........#....#.#...\n" +
    "###................#.#....#....\n" +
    "#..#.##.#.............#..#.....\n" +
    ".....#............#.....##.....\n" +
    "....#.....#....#.........#.....\n" +
    "#..#...........###.#....#......\n" +
    "..#............##...#........##\n" +
    "..#....#..#....#.....#.......#.\n" +
    "..#..#.#.#.##.#..#...#.....#...\n" +
    "..........#..#.................\n" +
    "...#.#......#..##........#.....\n" +
    "...............#...............\n" +
    "#.......#.......#....#.........\n" +
    "#...........#....#.............\n" +
    "....#..#..........#....#..##...\n" +
    ".........#.#.#.........#......#\n" +
    ".....#...##.....#.#.......#...#\n" +
    ".........#....#...#.......#....";
var output = "181";

function get_nb_tree_encounter(lines) {
    var width_pattern = lines[0].length;  // get width pattern
    var height_pattern = lines.length;  // get height pattern
    var map = [];  // initialize map
    lines.forEach(function(line) {
        var line_map = [];  // init line

        for (var i = 0; i < line.length; i++) {
            line_map.push(line[i]);  // add a tree or an open path
        }
        map.push(line_map);  // add a line in the map
    });

    var move_list = [[3, 1]];  // intialize moves to do

    // count tree
    function get_nb_tree_encounter_using_map_and_moves(map, move) {  // function to use in first part
        var current_pos = [0, 0];  // start at the top-left
        var nb_tree_encounter = 0;  // initialize the count
        while (current_pos[1] < height_pattern - 1) {// browse until the end
            current_pos = [(current_pos[0] + move[0]) % width_pattern, (current_pos[1] + move[1])];  // add a move
            //console.log(current_pos + " " + height_pattern + " ");
            if(map[current_pos[1]][current_pos[0]] === "#") {// test if there was a tree
                nb_tree_encounter += 1;  // add into the count
            }
        }
        return nb_tree_encounter  // return the nb of tree encounter
    }

    var nb_tree_encounter_product = 1  // initialize the count
    move_list.forEach(function(move) { // for each moves in the move list
        nb_tree_encounter_product *= get_nb_tree_encounter_using_map_and_moves(map, move)  // get the number of tree encounter and multiply
    });

    return nb_tree_encounter_product  // case it won't work
}

var assert = require('assert'); // Unit test library
describe('Day 3', function() {
    it('NbTreeEncounterPart12020', function() {
        var lines = input.split("\n"); // get lines
        var res = get_nb_tree_encounter(lines); // process
        console.log(res);
        assert.equal(res.toString(), output); // check if it works
    });
});